<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>
	<title>TuneBox | Unbox the Music</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<script src="https://www.youtube.com/iframe_api"></script>

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<link rel="stylesheet" type="text/css" href="https://unpkg.com/swiper/swiper-bundle.min.css" />
	<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
	<link rel="stylesheet" href="assets/css/main.css" />
	<script src="https://apis.google.com/js/api.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
	<script src="assets/js/ajaxCalls.js"></script>
	<script src="assets/js/searchForm.js"></script>

	<script src="assets/js/SongPageINIT.js"></script>
	<script src="assets/js/admin-activ.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
	<script src="assets/js/signInInit-mutual.js"></script>
	<link href="assets/css/dropdown.css" rel="stylesheet" />
	<link href="assets/css/scc.css" rel="stylesheet" />
	<style>
		@import url('https://fonts.googleapis.com/css2?family=Poppins&display=swap');

		body, h1, h2, h3, h4, h5, h6, p {
			font-family: 'Poppins', sans-serif !important;
		}

		.search-wrapper {
			display: flex;
			align-items: center;
		}

		#search-category {
			width: 50%;
			color: #ff8d8d;
			background-color: #161616;
			margin-right: 10px;
		}


			#search-category option {
				color: dimgrey !important;
			}

		.collapsible {
			background-color: #121212;
			width: 460px;
			border-bottom: 3px solid #f73859;
		}

		.sp-container {
			margin-left: 40px;
		}

			.sp-container img {
				margin-right: 40px;
			}

		.content1 {
			width: 460px;
			height: 560px;
		}

		.card {
			background-color: #1b1b1b;
		}

		.container {
			max-width: 100%;
			margin-left: 0;
			margin-right: 0;
		}

		.desc {
			height: 250px;
			margin-bottom: -250px;
		}

		.comments {
			padding: 15px;
			border-radius: 5px;
			background: #1e1e1e;
			width: 460px;
			overflow-y: auto;
			margin-bottom: 50px;
			max-height: 400px;
		}

		#add-c {
			width: 90%;
			padding-left: 10px;
		}

		.popup {
			display: none;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(0, 0, 0, 0.7);
			z-index: 9999; /* Ensure the popup is on top of other content */
		}

		.popup-content {
			position: absolute;
			top: 50%;
			left: 50%;
			transform: translate(-50%, -50%);
			background-color: #1f1f1f;
			padding-top: 40px;
			border-radius: 10px;
			box-shadow: none; /* Remove the box shadow */
		}

			.popup-content .card {
				padding-left: 40px;
				padding-right: 40px;
				padding-top: 20px;
				padding-bottom: 30px;
			}

			.popup-content .formBTN {
				text-align: center;
				margin-top: 40px;
			}

			.popup-content .title {
				padding-bottom: 15px;
				font-size: 17px;
				text-align: center;
			}

		#logIn-form {
			font-size: 15px;
		}

		.close {
			position: absolute;
			top: 10px;
			right: 10px;
			font-size: 20px;
			cursor: pointer;
			margin-bottom: 5px;
		}

			.close:hover {
				color: #f74a67;
			}

		#iframe-video > iframe {
			margin-top: 250px;
			border-radius: 20px;
		}

		#lyrics {
			line-height: 27px;
		}

		#mobile-utube {
			display: none;
		}

		@media screen and (max-width: 576px) {


			.sp-details {
				padding-left: 10px;
			}

			.desc {
				margin-bottom: 10px;
				padding-right: 10px;
			}

			.collapsible {
			}

			#songImg {
				width: 100%;
			}

			#mobile-utube > iframe {
				margin-top: 100px;
				width: 100% !important;
				height: 180px;
				border-radius: 5px !important;
			}

			#mobile-utube {
				display: block;
			}

			#iframe-video {
				display: none;
			}

			#sp-fav {
				margin-right: 0;
			}

			#apple-container {
				display: none;
			}
		}
	</style>
</head>

<body class="is-preload">
	<div class="popup" id="loginPopup">
		<div class="popup-content">
			<span class="close" id="closeLoginPopup">&times;</span>
			<div class="card">
				<div class="title">Log in to TuneBox</div>
				<form id="logIn-form1">
					<div class="form-group">
						<label for="username">Email</label>
						<input type="email" id="email3" name="username" required>
					</div>
					<div class="form-group">
						<label for="password">Password</label>
						<input type="password" id="password3" name="password" required>
					</div>
					<div class="formBTN">
						<input type="submit" value="Log In">
					</div>
				</form>
				
				<div id="sign_up_log" class="text-center">
					Don't have an account? <a href="Signup-TuneBox.html">Sign up for TuneBox</a>
				</div>
			</div>
		</div>
	</div>

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Main -->
		<div id="main">
			<div class="inner">
				<!-- Header -->
				<header id="header">
					<div></div>
					<div id="search" class="alt">
						<form id="search-form">
							<div class="search-wrapper">
								<span class="search-button-indicator"></span>
								<select id="search-category">
									<option id="artistS" value="artist">By Artist</option>
									<option id="songS" value="song">By Song Name/Lyrics</option>
								</select>
								<input type="text" name="query" id="query" placeholder="Explore TuneBox Songs" />
								<i id="searchSubmit" class="fas fa-search search-icon"></i>
							</div>
						</form>
					</div>


					<div class="signIn">
						<span class="disconnected">
							<button onclick="window.location='Signup-TuneBox.html'" class="signUp">Sign Up</button>
							<button onclick="window.location='Login-TuneBox.html'" class="logIn">Log In</button>
						</span>
						<span class="connected">
							<img onclick="myFunction()" class="userAvatar dropbtn" src="#" alt="user avatar" />
							<div class="dropdown">
								<div id="myDropdown" class="dropdown-content">
									<a href="MyFavorites.html"><img id="menu-fav" width="20" src="images/heart.png" /></a>
									<!--<a href="#">My Account</a>-->
									<a onclick="logOut()">Log Out</a>
								</div>
							</div>
						</span>
					</div>

				</header>

				<!-- Banner -->
				<section id="banner">
					<div class="content">

						<div class="sp-container">
							<div class="sp-img">
								<img id="songImg" />
								<div class="collapsible">Lyrics</div>
								<div class="content1 lyrics">
									<p id="lyrics">
										I chose to believe every word I was fed<br>
										And I thought the coals on my back were a product of the lack you left<br>
										When you stepped back and racked your brain for a reason to stay<br>
										But you could not seem to formulate any such thought in your head<br>
										So you left with nothing more than a reason you kept silent<br>
										And my mind would riot, stuck in self-perpetuated mental violence and dreams kept private<br>
										The ambition to fix this wishlist of selfish, misfit, realist missions<br>
										Contained within a vision of wishful thinking and sinking deep into a new bit of misproportioned emotions<br>
										Leaking through a seeping truth, constructed by my need to feel important<br>
										When you would look back and think of all the little things you regret<br>
										I just wanted you think of me when you'd think back to all the things you regret<br>
										I spent so much time convincing myself that the rest of this mess that I stressed<br>
										Within this relationship was a product of the world's oppressions<br>
										Not my deep desire to be needed<br>
										And it's hard to admit, but I guess I've come to terms with the fact that I just want to be needed<br>
										And I convinced myself that I needed to be needed<br>
										And if that was true, I would still be smiling like you still today, but for different reasons<br>
										I chose to dismiss the possible instance that the lips I love to kiss could form the words "goodbye"<br>
										And it was a simple lie, but I told it to you, like the captain of a sinking ship<br>
										Choosing to believe the bottom of the ocean was a better source of oxygen<br>
										It's so nice and I still chose to believe, I misinterpreted your dialect and everything you said about it<br>
										Your diction and diatribe, posture, body language, and connotations all pointing in the same direction<br>
										The selection of contingent messages postponed until further notice<br>
										Because I was ashamed to admit the problem and pretend your happiness came from me and that your happiness was important<br>
										But we aborted the sordid truths we once distorted when I saw the shape of your dress when you wore it<br>
										And that was enough until it wasn't<br>
										And that's when you finally felt supported<br>
										So the others courted you and you mentally recorded and endorsed<br>
										The force perform, of compliments you received came in<br>
										And you felt empowered enough to take your final bow<br>
										And find love within the arms of another, instead of this heart of mine<br>
										And that's fine, because I would do the same and I would leave me<br>
										Not because I'm useless and not because I'm broken<br>
										Not because I'm sad and not because I'm worthless<br>
										But because I saw value in your smile and not in your values<br>
										And I'm sorry and I love you<br>
										And that's why I can finally sleep at night<br>
										Because you are free and you can thrive<br>
										And I'm just happy I got to be a part of your life<br>
										I'm just happy I got to be a part of the journey that you call your life<br>
										And I finally feel fine, 'cause I spent so long trying to change you<br>
										Not realizing I was the one who needed to change<br>
										I was selfish to assume you loved me more than you loved yourself<br>
										Even though I never felt the same<br>
										And there's so many things that my selfishness tried to take away<br>
										But you were the one that was the hardest to watch walk away<br>
										But thank.
									</p>
								</div>
								<br />
								<section class="comments">
									<div class="container  " style="width:500px;">
										<div class="row d-flex">
											<div id="cmt-jq" class="col">
												<span style="color:dimgrey" id="new-ans"></span>
											</div>
										</div>
									</div>
								</section>
								<div class="d-flex flex-start" id="add-c">
									<img id="sp-avatar" class="rounded-circle shadow-1-strong "
										 src="avatars/avatar5.png" alt="avatar" width="65"
										 height="65" />
									<div class="w-100">
										<h5>Add a comment</h5>
										<form id="cmt-form">
											<div class="form-outline">
												<textarea class="form-control" id="textAreaExample" rows="4" required></textarea>
												<label class="form-label" for="textAreaExample">What is your view?</label>
											</div>
											<input style="float:right" type="submit" id="add-cmt" value="Add comment" />
										</form>
									</div>
								</div>

							</div>
							<div class="sp-details">
								<div style="display: flex; justify-content: space-between; max-width:95%;">
									<h2 id="sp-name"></h2>
									<span> <img onclick="favorite()" onmouseout="heartOut()" onmouseover="heartHover()" id="sp-fav" width="25" src="images/heart.png" /></span>
								</div>
								<a id="sp-artist" href="#"></a>
								<p id="al-name"><strong>Album</strong> &nbsp;&nbsp;|&nbsp;&nbsp; <span id="albumName"></span></p>
								<p id="r-date"><strong>Release Date:</strong> &nbsp;&nbsp;|&nbsp;&nbsp;<span id="releaseDate"></span></p>
								<br />


								<div id="apple-container">
									<iframe id="apple" frameborder="0" allowtransparency="true" style="width: 100%;  color:white !important; height: 50px !important;"></iframe>
								</div>
								<div class="collapsible">Song Overview</div>
								<div class="content1 desc">
									<p id="sp-desc"></p>
								</div>
								<br />
								<br />
								<div id="iframe-video"></div>


							</div>


						</div>

				</section>
				<div id="mobile-utube"></div>

				<!-- Section -->
				<section style=" margin-bottom: 120px;">
					<header class="major">
						<h2>Featured</h2>
					</header>

					<div class="slider-container">
						<div class="slider-content">
							<div id="slide1" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide2" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide3" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide4" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide5" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide6" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide7" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide8" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide9" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
						</div>

						<div class="slider-nav">
							<button class="prev" disabled>&#8249;</button>
							<button class="next">&#8250;</button>
						</div>
					</div>


					<div style="margin-top:30px; margin-bottom:80px;" class="slider-container">
						<header class="major">
							<h2>Explore TuneBox Artists</h2>
						</header>
						<div class="slider-content">
							<div id="slide10" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide11" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide12" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide13" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide14" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide15" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide16" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide17" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide18" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
						</div>

						<div class="slider-nav">
							<button class="prev" disabled>&#8249;</button>
							<button class="next">&#8250;</button>
						</div>
					</div>
				</section>

			</div>
		</div>

		<!-- Sidebar -->
		<div id="sidebar">
			<div class="inner">

				<!-- Menu -->
				<nav id="menu">
					<img src="tboxLogo.png" width="180" />

					<ul style="padding-top:50px;">
						<li><a href="index.html">Homepage</a></li>
						<li><a href="TuneBox-Arttists.html">TuneBox Artists</a></li>
						<li><a href="TuneBox-Quiz.html"><img width="150" src="images/tunebox_quiz.png" /></a></li>
					</ul>
				</nav>
				<div id="search2" class="alt">
					<form id="search-form1">
						<div class="search-wrapper">
							<span class="search-button-indicator"></span>
							<select id="search-category1">
								<option id="artistS1" value="artist">By Artist</option>
								<option id="songS1" value="song">By Song Name/Lyrics</option>
							</select>

							<input type="text" name="query1" id="query1" placeholder="Explore TuneBox Songs" />
							<i id="searchSubmit1" class="fas fa-search search-icon"></i>
						</div>
					</form>
				</div>
				<footer id="footer">
					<p class="copyright">&copy; Untitled. TuneBox All rights reserved</a>.</p>
				</footer>

			</div>
		</div>


	</div>


	<script>
		$(document).ready(function () {

			$('#logIn-form1').submit(login)
			function login() {
				var logged = sessionStorage['logged'];
				if (logged != null) {
					alert("You are currently logged in to your account");
				}
				else {
					const api = "https://proj.ruppin.ac.il/cgroup40/test2/tar1/api/Users/UserLogIn/" + $('#email3').val() + "/" + $('#password3').val();
					//const api = "https://proj.ruppin.ac.il/cgroup40/test2/tar1/api/User/UserLogIn/" + val[0] + "%40" + val[1] + "/" + $('#password').val();
					ajaxCall("POST", api, { email: $('#email3').val(), password: $('#password3').val() }, successCBh, errorCB);
					return false;
				}
			}
			function successCBh(user) {
				sessionStorage['logged'] = JSON.stringify(user);
				location.reload();

			}

			function errorCB(err) {
				if (err.status === 500) {
					alert("Error: " + err.responseText);
				} else {
					alert("Sorry, we could not complete your request because the server connection might have been lost or the data was undefined.");
				}
			}

		});



	</script>
	<!-- Scripts -->

	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>
	<script src="assets/js/JavaScript.js"></script>
	<script>
		var comment;
		var comment1;
		var newAns = false;
		var noCmt;
		var url = new URLSearchParams(window.location.search);
		var songId = url.get('id');
		$(document).ready(function () {
			const api_a = "https://proj.ruppin.ac.il/cgroup40/test2/tar1/api/Comments/" + songId;
			ajaxCall("GET", api_a, "", successCBb, errorCBb);

			function successCBb(data) {
				newAns = false;
				if (data.length == 0) {
					noCmt = true;
					$('#new-ans').text("No comments yet");
				}
				else {
					$("#new-ans").css("color", "white");
					for (let i = 0; i < data.length; i++) {
						let cdate = data[i].commentDate.toString();
						let bdate = cdate.split("T");
						let date = bdate[0] + " | " + bdate[1].split('.')[0];
						const cmt = {
							nickName: data[i].nickName,
							commentText: data[i].commentText,
							commentDate: date,
							avatar: data[i].avatar
						};
						addComment1(cmt);
					}
				}
			}
			$('#cmt-form').submit(addComment);
			function addComment() {
				let currentDate = new Date();
				let year = currentDate.getFullYear();
				let month = String(currentDate.getMonth() + 1).padStart(2, '0');
				let day = String(currentDate.getDate()).padStart(2, '0');
				let hours = String(currentDate.getHours()).padStart(2, '0');
				let minutes = String(currentDate.getMinutes()).padStart(2, '0');

				let now = `${year}-${month}-${day}, ${hours}:${minutes}`;

				if (sessionStorage['logged'] != null) {
					user = JSON.parse(sessionStorage['logged']);
					comment1 = {
						nickName: user.userName,
						songId: songId,
						avatar: user.avatar,
						commentText: $('#textAreaExample').val(),
						commentDate: now
					}
					comment = {
						nickName: user.userName,
						songId: songId,
						avatar: user.avatar,
						commentText: $('#textAreaExample').val()
					};
				}
				else {
					comment = {
						nickName: 'guest',
						songId: songId,
						avatar: 'avatars/avatar5.png',
						commentText: $('#textAreaExample').val(),
					}
					comment1 = {
						nickName: 'guest',
						songId: songId,
						avatar: 'avatars/avatar5.png',
						commentText: $('#textAreaExample').val(),
						commentDate: now
					}
				}
				const api = "https://proj.ruppin.ac.il/cgroup40/test2/tar1/api/Comments";
				ajaxCall("POST", api, JSON.stringify(comment), successCBa, errorCBb);
				return false;
			}
		});

		function successCBa(data) {
			newAns = true;
			addComment1(comment1);
		}

		function errorCBb(err) {
			alert("Sorry, we could not complete your request because the server connection might have been lost or the data was undefined.");
		}

		function addComment1(cmt) {
			if (noCmt) {
				$('#new-ans').text(" ");
				noCmt = false;
				$("#new-ans").css("color", "white");

			}
			if (!newAns) {
				$('#cmt-jq').append(`
			<div class="d-flex flex-start mb-4">
			  <img id="sp-avatar" class="rounded-circle shadow-1-strong me-3 mr-1" src="${cmt.avatar}" alt="avatar" width="65" height="65" />
			  <div class="card w-100">
				<div class="card-body p-4">
				  <div>
					<h5 id="sp-user-cmnt">${cmt.nickName}</h5>
					<p id="sp-date-cmt" class="small">${cmt.commentDate}</p>
					<p id="sp-cmt">${cmt.commentText}</p>
					<div class="d-flex justify-content-between align-items-center">
					  <div class="d-flex align-items-center"></div>
					</div>
				  </div>
				</div>
			  </div>
			</div>
		  `);
			}
			else {
				$('#new-ans').append(`
			<div class="d-flex flex-start mb-4">
			  <img id="sp-avatar" class="rounded-circle shadow-1-strong me-3 mr-1" src="${cmt.avatar}" alt="avatar" width="65" height="65" />
			  <div class="card w-100">
				<div class="card-body p-4">
				  <div>
					<h5 id="sp-user-cmnt">${cmt.nickName}</h5>
					<p id="sp-date-cmt" class="small">${cmt.commentDate}</p>
					<p id="sp-cmt">${cmt.commentText}</p>
					<div class="d-flex justify-content-between align-items-center">
					  <div class="d-flex align-items-center"></div>
					</div>
				  </div>
				</div>
			  </div>
			</div>
		  `);
			}
		}




	</script>
</body>
</html>