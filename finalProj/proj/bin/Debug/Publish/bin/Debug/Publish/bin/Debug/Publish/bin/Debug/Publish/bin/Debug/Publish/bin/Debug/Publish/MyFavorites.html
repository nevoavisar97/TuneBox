<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
<head>
	<title>TuneBox | My Favorites</title>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" type="text/css" href="https://unpkg.com/swiper/swiper-bundle.min.css" />

	<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

	<link rel="stylesheet" href="assets/css/main.css" />
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
	<script src="https://apis.google.com/js/api.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>

	<script src="assets/js/admin-activ.js"></script>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
	<script src="assets/js/ajaxCalls.js"></script>
	<script src="assets/js/artistDBinit.js"></script>
	<script src="assets/js/songsDBinit.js"></script>
	<script src="assets/js/searchForm.js"></script>
	<script src="assets/js/signInInit-mutual.js"></script>

	<style>
		@import url('https://fonts.googleapis.com/css2?family=Poppins&display=swap');

		.search-wrapper {
			display: flex;
			align-items: center;
		}

		#search-category {
			width: 50%;
			color: #ff8d8d;
			background-color: #161616;
			margin-right: 10px;
		}



			#search-category option {
				color: dimgrey !important;
			}

		#res-head {
			margin-top: 20px;
		}

		.pagination {
			margin-top: 50px;
			margin-left: 50px;
			margin-bottom: 30px;
			width: 100%;
		}

			.pagination button {
				height: 40px;
				margin-right: 10px;
				margin-bottom: 10px;
				width: 50px;
			}

				.pagination button:hover,
				.pagination button.active {
					background-color: #381b1b;
					color: white;
				}

		@media screen and (max-width: 500px) {
		}
	</style>
	<link href="assets/css/dropdown.css" rel="stylesheet" />
</head>

<body class="is-preload">

	<!-- Wrapper -->
	<div id="wrapper">

		<!-- Main -->
		<div id="main">
			<div class="inner">
				<!-- Header -->
				<header id="header">
					<div></div>
					<div class="alt" id="search">
						<form id="search-form">
							<div class="search-wrapper">
								<span class="search-button-indicator"></span>
								<select id="search-category">
									<option id="artistS" value="artist">By Artist</option>
									<option id="songS" value="song">By Song Name/Lyrics</option>
								</select>
								<input type="text" name="query" id="query" placeholder="Explore TuneBox Songs" />
								<i id="searchSubmit" class="fas fa-search search-icon"></i>
							</div>
						</form>
					</div>


					<div class="signIn">
						<span class="disconnected">
							<button onclick="window.location='Signup-TuneBox.html'" class="signUp">Sign Up</button>
							<button onclick="window.location='Login-TuneBox.html'" class="logIn">Log In</button>
						</span>
						<span class="connected">
							<img onclick="myFunction()" class="userAvatar dropbtn" src="#" alt="user avatar" />
							<div class="dropdown">
								<div id="myDropdown" class="dropdown-content">
									<a href="MyFavorites.html"><img id="menu-fav" width="20" src="images/heart.png" /></a>
									<!--<a href="#">My Account</a>-->
									<a onclick="logOut()">Log Out</a>
								</div>
							</div>
						</span>
					</div>
					<!-- Search -->
				</header>

				<!-- Banner -->
				<header id="fav-head">
					<img src="images/tboxLogoFav.png" />
				</header>
				<section id="banner">
					<div id="favorites">


					</div>
				</section>

				<!-- Section -->
				<section>
					<header class="major">
						<h2>Featured</h2>
					</header>

					<div class="slider-container">
						<div class="slider-content">
							<div id="slide1" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide2" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide3" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide4" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide5" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide6" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide7" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide8" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide9" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
						</div>

						<div class="slider-nav">
							<button class="prev" disabled>&#8249;</button>
							<button class="next">&#8250;</button>
						</div>
					</div>

					<div style="margin-top:30px;" class="slider-container">
						<header class="major">
							<h2>Explore TuneBox Artists</h2>
						</header>
						<div class="slider-content">
							<div id="slide10" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide11" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide12" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide13" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide14" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide15" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide16" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide17" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
							<div id="slide18" class="slide">
								<img src="#" />
								<h3></h3>
								<h5></h5>
							</div>
						</div>

						<div class="slider-nav">
							<button class="prev" disabled>&#8249;</button>
							<button class="next">&#8250;</button>
						</div>
					</div>
				</section>
			</div>
		</div>

		<!-- Sidebar -->
		<div id="sidebar">
			<div class="inner">

				<!-- Menu -->
				<nav id="menu">
					<img src="tboxLogo.png" width="180" />

					<ul style="padding-top:50px;">
						<li><a href="index.html">Homepage</a></li>
						<li><a href="TuneBox-Arttists.html">TuneBox Artists</a></li>
						<li><a href="TuneBox-Quiz.html"><img width="150" src="images/tunebox_quiz.png" /></a></li>
					</ul>
				</nav>
				<div id="search2" class="alt">
					<form id="search-form1">
						<div class="search-wrapper">
							<span class="search-button-indicator"></span>
							<select id="search-category1">
								<option id="artistS1" value="artist">By Artist</option>
								<option id="songS1" value="song">By Song Name/Lyrics</option>
							</select>

							<input type="text" name="query1" id="query1" placeholder="Explore TuneBox Songs" />
							<i id="searchSubmit1" class="fas fa-search search-icon"></i>
						</div>
					</form>
				</div>
				<footer id="footer">
					<p class="copyright">&copy; Untitled. TuneBox All rights reserved</a>.</p>
				</footer>

			</div>
		</div>


	</div>



    <script>

        /////heart clicked//////////
		function favorite() {
                let user = JSON.parse(sessionStorage['logged']).id;
                //add to favorites
                if (faved == false) {
                    $('#sp-fav').attr('src', 'images/heartFull.png');
                    faved = true;
                }
                //remove from favorites
                else {
                    $('#sp-fav').attr('src', 'images/heart.png');
                    faved = false;
                }
                //update db
                const api = "https://localhost:7248/api/Users/AddRemoveFav/" + user + "/" + songId;
                ajaxCall("POST", api, "", successCBc, errorCB);
            
        }


        function successCBc(data) {
            console.log(data + ' success');
        }

        function errorCB(err) {
            alert("Could not complete your request, Server might be down");
        }

	</script>

    <script>
        function myFunction() {
            document.getElementById("myDropdown").classList.toggle("show");
        }

        // Close the dropdown if the user clicks outside of it
        window.onclick = function (event) {
            if (!event.target.matches('.dropbtn')) {
                var dropdowns = document.getElementsByClassName("dropdown-content");
                var i;
                for (i = 0; i < dropdowns.length; i++) {
                    var openDropdown = dropdowns[i];
                    if (openDropdown.classList.contains('show')) {
                        openDropdown.classList.remove('show');
                    }
                }
            }
		}


		function logOut() {
			let tmp = sessionStorage['searchWord'];
			sessionStorage.clear();
			sessionStorage['searchWord'] = "page reloaded: please search again";
            location.reload();

        }
	</script>
    <script>
        let currentPage = 1;
        const resultsPerPage = 6;

		$(document).ready(function () {
			let id = JSON.parse(sessionStorage['logged']).id;
			const api = "https://localhost:7248/api/Users/GetUserFavorites/" + id;
            ajaxCall("GET", api, "", successCBe, errorCBb);
			var data;

			function successCBe(favs) {
				data = favs;
                getFavorites(); 
            }

            function getFavorites() {

                let container = document.getElementById('favorites');
                let dataCount = data.length;

                // Calculate the total number of pages
                const totalPages = Math.ceil(dataCount / resultsPerPage);

                // Calculate the starting index and ending index of results for the current page
                const startIndex = (currentPage - 1) * resultsPerPage;
                const endIndex = Math.min(startIndex + resultsPerPage, dataCount);

                // Clear the container before populating the results for the current page
                container.innerHTML = '';

				if (dataCount > 0) {
					clicked = false;
                    for (let i = startIndex; i < endIndex; i++) {
                        let card = document.createElement('div');
                        card.classList = "res-card";
                        let img = document.createElement('img');
						img.src = data[i].imgUrl;
						let heartDiv = document.createElement('div');
						let heart = document.createElement('img');
						heart.src = 'images/heartfull.png';
						heart.id = data[i].id;
						heart.onclick = function () {
							clicked = true;
							const api = "https://localhost:7248/api/Users/AddRemoveFav/" + id + "/" + heart.id;
                            ajaxCall("POST", api, "", successCBf, errorCB);
                        }

                        heartDiv.appendChild(heart);
                        let details = document.createElement('div');
                        details.id = "card-details";
                        let h3 = document.createElement('h3');
                        h3.textContent = data[i].songName;
                        let h5 = document.createElement('h5');
						h5.textContent = data[i].artistName;
						let h5b = document.createElement('h5');
						h5b.textContent = data[i].albumName;
						card.appendChild(img);
                        details.appendChild(h3);
						details.appendChild(h5);
						if (h5b.textContent != "0") 
							details.appendChild(h5b);
						card.appendChild(details);
						heartDiv.classList = 'heart-icon';
                        card.appendChild(heartDiv);
						card.onclick = function () {
							if (clicked == false)
								window.location.href = "songPage.html?id=" + data[i].id;
							else clicked = false;
						};
						container.appendChild(card);
                    }
                }

                // Create pagination buttons at the bottom of the results
                let paginationContainer = document.createElement('div');
                paginationContainer.classList = 'pagination';

                for (let i = 1; i <= totalPages; i++) {
                    let pageButton = document.createElement('button');
                    pageButton.textContent = i;
                    pageButton.onclick = function () {
                        currentPage = i;
                        getFavorites(); 
                    };

                    // Add "active" class to the current page button
                    if (i === currentPage) {
                        pageButton.classList.add('active');
                    }

                    paginationContainer.appendChild(pageButton);
                }

                container.appendChild(paginationContainer);
			}
            function errorCBb(err) {
                alert("Sorry, we could not complete your request because the server connection might have been lost or the data was undefined.");
			}
			function successCBf() {
                location.reload();
			}
        });
	</script>
	<!-- Scripts -->
	<script src="assets/js/jquery.min.js"></script>
	<script src="assets/js/browser.min.js"></script>
	<script src="assets/js/breakpoints.min.js"></script>
	<script src="assets/js/util.js"></script>
	<script src="assets/js/main.js"></script>
	<script src="assets/js/JavaScript.js"></script>

</body>
</html>